/* ════════════════════════════════════════════════════════════════════
   🛠️ USER CONFIGURABLE VARIABLES — SAFE TO EDIT

   The following values control appearance settings such as colors,
   dimensions, and animation timing. You are welcome to customize
   them — but DO NOT edit them directly in this file.

   ✅ Instead, to safely override any value:
      1. Create a file named `uc-user-settings.css` inside the `components` folder.
      2. Copy the relevant selector block (e.g. `:root`)
         that contains the variable(s) you want to change.
      3. Paste and edit them in your `uc-user-settings.css` file.

   🛡️ Why? The `uc-user-settings.css` file is loaded last and will override values here.
   It will not be affected by updates, so your changes will be preserved.

   ⚠️ IMPORTANT: If a variable is defined inside a selector (like `:root:has(...)`),
   be sure to copy the *entire block*, not just the variable — this ensures
   your overrides will take effect properly.
════════════════════════════════════════════════════════════════════ */
:root {
    /* ════════════════════════════════════════════════════════════════════
     ██████╗ ██████╗ ██╗      ██████╗ ██████╗     ███████╗ ██████╗██╗  ██╗███████╗███╗   ███╗███████╗
    ██╔════╝██╔═══██╗██║     ██╔═══██╗██╔══██╗    ██╔════╝██╔════╝██║  ██║██╔════╝████╗ ████║██╔════╝
    ██║     ██║   ██║██║     ██║   ██║██████╔╝    ███████╗██║     ███████║█████╗  ██╔████╔██║█████╗  
    ██║     ██║   ██║██║     ██║   ██║██╔══██╗    ╚════██║██║     ██╔══██║██╔══╝  ██║╚██╔╝██║██╔══╝  
    ╚██████╗╚██████╔╝███████╗╚██████╔╝██║  ██║    ███████║╚██████╗██║  ██║███████╗██║ ╚═╝ ██║███████╗
     ╚═════╝ ╚═════╝ ╚══════╝ ╚═════╝ ╚═╝  ╚═╝    ╚══════╝ ╚═════╝╚═╝  ╚═╝╚══════╝╚═╝     ╚═╝╚══════╝
                                                                                                     
       🎨 COLOR SCHEME — FLEXFOX THEME PALETTE
    
       This section defines the color palette used by the FlexFox theme.
       You can customize these to create your preferred visual style.
    ════════════════════════════════════════════════════════════════════ */
    /* 🔽 Start of color scheme definitions for FlexFox Theme */
    @media (prefers-color-scheme: dark) {
        --uc-bgcolor: #1a1b26; /* Background color of the toolbar */
        --uc-urlbar-outline: #414868; /* Outline color that appears when hovering over the URL bar */

        @media not (-moz-pref("uc.flex.allow-addons-to-change-toolbar-color") or -moz-pref("uc.flex.browser-wallpaper-enabled")) {
            @media -moz-pref("extensions.activeThemeID", "default-theme@mozilla.org") and (not -moz-pref("widget.windows.mica")),
                -moz-pref("extensions.activeThemeID", "firefox-compact-light@mozilla.org"),
                -moz-pref("extensions.activeThemeID", "firefox-compact-dark@mozilla.org") {
                &:not([lwtheme-image], [style*="--lwt-additional-images"]) {
                    --lwt-accent-color: rgb(26, 27, 38) /*rgb(28, 27, 34)*/ !important;
                    --lwt-accent-color-inactive: rgb(31, 30, 37) !important;

                    --uc-urlbar-bg: #0d0d15; /* Background color of the URL bar */
                    --uc-urldrop-bg: #0d0d15; /* Background color of the expanded URL bar dropdown */
                    --uc-urlbar-border-top: #000; /* Top border color when the URL bar is focused */
                    --uc-urlbar-border-bottom: #404040; /* Bottom border color when the URL bar is focused */

                    --arrowpanel-background: var(
                        --uc-urlbar-bg
                    ) !important; /* Toolbar button dropdown background color */
                    --arrowpanel-border-color: rgb(55, 55, 55) !important; /* Toolbar button dropdown border color */

                    --identity-btn-hover-color: rgba(
                        117,
                        117,
                        117
                    ) !important; /* Hover color for the URL bar lock icon */

                    /* Unused legacy vars – kept in case fallback is needed */
                    /*
                    --urlbar-height: 30px;
                    --button-hover-bgcolor: rgba(159, 159, 159, 0.35) !important;
                    --button-active-bgcolor: rgba(255, 255, 255, 0.2) !important;
                    --button-bgcolor: rgba(117, 117, 117, 0.9) !important;
                    --toolbarbutton-icon-fill-opacity: 0.8 !important;

                    --dark-menu-background-color: rgba(34, 34, 36, 0.5) !important;
                    --dark-menu-border-color: rgb(55, 55, 55) !important;
                    --dark-menuitem-hover-background-color: rgba(159, 159, 159, 0.35) !important;
                    */
                }
            }
        }
    }

    @media (prefers-color-scheme: light) {
        --uc-bgcolor: #f1f5f9; /* Background color of the toolbar */
        --uc-urlbar-outline: #94a3b8; /* Outline color that appears when hovering over the URL bar */

        @media not (-moz-pref("uc.flex.allow-addons-to-change-toolbar-color") or -moz-pref("uc.flex.browser-wallpaper-enabled")) {
            @media -moz-pref("extensions.activeThemeID", "default-theme@mozilla.org") and (not -moz-pref("widget.windows.mica")),
                -moz-pref("extensions.activeThemeID", "firefox-compact-light@mozilla.org"),
                -moz-pref("extensions.activeThemeID", "firefox-compact-dark@mozilla.org") {
                &:not([lwtheme-image], [style*="--lwt-additional-images"]) {
                    --lwt-accent-color: rgb(241, 245, 249) /*rgb(240, 240, 244)*/ !important;
                    --lwt-accent-color-inactive: rgb(235, 235, 239) !important;

                    --uc-urlbar-bg: #cbd5e1; /* Background color of the URL bar */
                    --uc-urldrop-bg: #cbd5e1; /* Background color of the expanded URL bar dropdown */
                    --uc-urlbar-border-top: #9ca3af; /* Top border color when the URL bar is focused */
                    --uc-urlbar-border-bottom: #fff; /* Bottom border color when the URL bar is focused */

                    --arrowpanel-background: #e2e8f0 !important; /* Toolbar button dropdown background color */

                    --identity-btn-hover-color: white !important; /* Hover color for the URL bar lock icon */

                    /* Unused legacy vars – kept in case fallback is needed */
                    /*
                    --button-hover-bgcolor: #9699a3 !important;
                    --button-hover-bgcolor: #cbd5e1 !important;
                    --button-active-bgcolor: #cbd5e1 !important;
                    */
                }
            }
        }
    }
    --uc-fullscreen-warn: rgb(25, 25, 25); /* Background color of the fullscreen warning prompt */
    /* 🔼 End of color scheme definitions */

    /* ════════════════════════════════════════════════════════════════════
    ██████╗  █████╗ ███████╗███████╗    ███████╗████████╗██╗   ██╗██╗     ███████╗
    ██╔══██╗██╔══██╗██╔════╝██╔════╝    ██╔════╝╚══██╔══╝╚██╗ ██╔╝██║     ██╔════╝
    ██████╔╝███████║███████╗█████╗      ███████╗   ██║    ╚████╔╝ ██║     █████╗  
    ██╔══██╗██╔══██║╚════██║██╔══╝      ╚════██║   ██║     ╚██╔╝  ██║     ██╔══╝  
    ██████╔╝██║  ██║███████║███████╗    ███████║   ██║      ██║   ███████╗███████╗
    ╚═════╝ ╚═╝  ╚═╝╚══════╝╚══════╝    ╚══════╝   ╚═╝      ╚═╝   ╚══════╝╚══════╝
                                                                                  
       🧩 LAYOUT & HIGHLIGHT SETTINGS
    
       Base style variables for layout behaviors, animations, icon sizes,
       element positions, and highlight colors used in key theme elements
       like the logo, stripe, and bookmark star.
    ════════════════════════════════════════════════════════════════════ */
    /* 🔽 Start of layout and highlight definitions */
    --uc-bookmark-star-color: light-dark(#ea4c89, #9651ff); /* Color of the bookmark star icon in the address bar */
    --uc-bookmark-star-image: url("../icons/bookmark/bookmark.svg"); /* SVG image used for the bookmark star icon in the address bar */

    --uc-sidebar-header-stripe: light-dark(#ea4c89, #9651ff); /* Color of the sidebar header stripe */
    --uc-sidebar-width: 44px; /* Width when Sidebery or vertical tabs are collapsed */
    --uc-sidebar-hover-width: 220px; /* Width when Sidebery is expanded */
    /* Increase expanded width of Sidebery */
    @media -moz-pref("uc.flex.increase-sidebery-expanded-width") {
        --uc-sidebar-hover-width: 260px;
    }

    /* FlexFox logo */
    --uc-flexfox-logo-color: color-mix(
        in srgb,
        var(--uc-sidebar-header-stripe) 77%,
        var(--uc-toolbar-bgcolor)
    ); /* Tint color applied to the FlexFox logo */
    @media (prefers-color-scheme: dark) {
        --uc-flexfox-logo-color: color-mix(
            in srgb,
            var(--uc-sidebar-header-stripe) 100%,
            var(--uc-toolbar-bgcolor)
        ); /* Adjusted logo color for dark theme */
    }
    --uc-flexfox-logo-image: url("../icons/toolbarbutton/flexfox.svg"); /* SVG image used for the FlexFox logo shown in the sidebar button */

    /* List all tabs button */
    --uc-list-all-tabs-color: var(--uc-flexfox-logo-color);
    @media (prefers-color-scheme: dark) {
        --uc-list-all-tabs-color: #b584ff;
    }
    --uc-list-all-tabs-image: url("../icons/toolbarbutton/list-all-tabs.svg");

    /* Gradient highlight color (used when gradient highlight is enabled) */
    @media -moz-pref("uc.flex.enable-gradient-highlight") {
        --uc-gradient-highlight: linear-gradient(to top right in oklab, oklch(70% 0.5 340) 0%, oklch(90% 0.5 200) 100%);
        @media (prefers-color-scheme: dark) {
            --uc-gradient-highlight: linear-gradient(
                to top right in oklab,
                oklch(55% 0.45 350) 0%,
                oklch(95% 0.4 95) 100%
            );
        }
    }

    /* Bookmark folder icons */
    --uc-bookmark-folder-color-1: #ccb76d; /* Color for the first bookmark folder */
    --uc-bookmark-folder-color-2: #50a466; /* Color for the second bookmark folder */
    --uc-bookmark-folder-color-3: #ef9875; /* Color for the third bookmark folder */
    --uc-bookmark-folder-color-4: #ef6f6f; /* Color for the fourth bookmark folder */
    --uc-bookmark-folder-color-5: #f073ec; /* Color for the fifth bookmark folder */
    --uc-bookmark-folder-color-6: #b475f5; /* Color for the sixth bookmark folder */
    --uc-bookmark-folder-color-7: #85caf4; /* Color for the seventh bookmark folder */
    --uc-bookmark-folder-color-8: #717cf4; /* Color for the eighth bookmark folder */
    --uc-bookmark-folder-color-9: #8f7044; /* Color for the ninth bookmark folder */

    --uc-bookmark-folder-size: 20px; /* Size of the bookmark folder icon */
    --uc-bookmark-folder-position: 0px 0px; /* Position of the bookmark folder icon */
    --uc-bookmark-folder-open-size: 17.5px; /* Size of the open folder icon */
    --uc-bookmark-folder-open-position: 2px 1px; /* Position of the open folder icon */
    --uc-bookmark-folder-padding: 4px 2px; /* Padding around the folder icon */
    --uc-bookmark-sub-folder-icon: url("../icons/bookmark/sub-folder.svg"); /* Icon for subfolders */
    --uc-bookmark-sub-folder-open-icon: url("../icons/bookmark/sub-folder-open.svg"); /* Icon for open subfolders */

    /* Folder icons used with colored folder setting 1 */
    @media -moz-pref("uc.flex.enable-colored-bookmarks-folder-icons", 1) {
        --uc-bookmark-folder-open-icon: url("../icons/bookmark/folder-open.svg");
        --uc-bookmark-folder-icon-1: url("../icons/bookmark/folder.svg");
        --uc-bookmark-folder-icon-2: url("../icons/bookmark/folder.svg");
        --uc-bookmark-folder-icon-3: url("../icons/bookmark/folder.svg");
        --uc-bookmark-folder-icon-4: url("../icons/bookmark/folder.svg");
        --uc-bookmark-folder-icon-5: url("../icons/bookmark/folder.svg");
        --uc-bookmark-folder-icon-6: url("../icons/bookmark/folder.svg");
        --uc-bookmark-folder-icon-7: url("../icons/bookmark/folder.svg");
        --uc-bookmark-folder-icon-8: url("../icons/bookmark/folder.svg");
        --uc-bookmark-folder-icon-9: url("../icons/bookmark/folder.svg");
    }
    /* Folder icons used with colored folder setting 2 */
    @media -moz-pref("uc.flex.enable-colored-bookmarks-folder-icons", 2) {
        --uc-bookmark-folder-open-icon: url("../icons/bookmark/sub-folder-open.svg");
        --uc-bookmark-folder-icon-1: url("../icons/bookmark/folder-1.svg");
        --uc-bookmark-folder-icon-2: url("../icons/bookmark/folder-2.svg");
        --uc-bookmark-folder-icon-3: url("../icons/bookmark/folder-3.svg");
        --uc-bookmark-folder-icon-4: url("../icons/bookmark/folder-4.svg");
        --uc-bookmark-folder-icon-5: url("../icons/bookmark/folder-5.svg");
        --uc-bookmark-folder-icon-6: url("../icons/bookmark/folder-6.svg");
        --uc-bookmark-folder-icon-7: url("../icons/bookmark/folder-7.svg");
        --uc-bookmark-folder-icon-8: url("../icons/bookmark/folder-8.svg");
        --uc-bookmark-folder-icon-9: url("../icons/bookmark/folder-9.svg");
    }

    /* 
     * Adjusts the horizontal offset of the bookmarks bar background image when using a theme. 
     * Use this variable if the image alignment looks off; supports positive and negative values. 
     */
    --uc-theme-bg-x-offset: 0px;

    /* Horizontal position of the findbar */
    --uc-findbar-x-position: 0.9vw;

    /* Adjusts the vertical position of the findbar */
    /** 
     * Positive values (e.g., 2px) shift it downward,
     * negative values (e.g., -2px) shift it upward.
     */
    --uc-findbar-y-position: 0px;

    /* Move the findbar to the top-center-left area of the window */
    @media -moz-pref("uc.flex.findbar-position", "top-center-left"), -moz-pref("uc.flex.findbar-position", "1") {
        --uc-findbar-x-position: 40.65vw;
        --uc-findbar-y-position: 0px;
    }
    /* Move the findbar to the bottom-right corner of the window */
    @media -moz-pref("uc.flex.findbar-position", "bottom-right"), -moz-pref("uc.flex.findbar-position", "3") {
        --uc-findbar-x-position: 0.9vw;
        --uc-findbar-y-position: calc(100% - 60px);
        --uc-findbar-y-offset: 0px !important;
    }

    /* Corner radius settings for the urlbar, searchbar, findbar, and their icons */
    @media not -moz-pref("uc.flex.revert-to-original-flat-corner-style") {
        --uc-urlbar-border-radius: 30px;
        --uc-urlbar-popup-border-radius: 15px;
        --uc-urlbar-icon-radius: 16px;
        --uc-urlbar-icon-inner-radius: 6px;
        --uc-searchbar-popup-border-radius: 12px;
        --uc-findbar-border-radius: 8px;
    }

    /* Adjusts background darkness behind the urlbar popup. Higher values = darker background. */
    @media -moz-pref("uc.flex.dim-urlbar-popup-backdrop", 1) {
        --uc-urlbar-popup-dimness: 0.25;
    }
    @media -moz-pref("uc.flex.dim-urlbar-popup-backdrop", 2) {
        --uc-urlbar-popup-dimness: 0.5;
    }

    /* Navbar icon auto-hide animation settings */
    --uc-autohide-navbar-icons-duration: 0.7s; /* Duration of fade-out transition when hiding navbar icons */
    --uc-hover-navbar-icons-duration: 0.3s; /* Duration of fade-in transition when showing navbar icons on hover */
    --uc-autohide-navbar-icons-type: ease; /* Easing type for navbar icon fade-in/out transitions */
    --uc-collapse-navbar-icons-duration: 0.28s; /* Duration of visibility collapse transition to remove icon spacing */

    /* Add margin, shadow, and rounded corners to the web content area */
    --uc-web-content-margin: 4px;
    @media -moz-pref("uc.flex.enable-rounded-web-content", 2) {
        --uc-web-content-margin: 8px;
    }
    --uc-web-content-radius: 8px;

    /* Mica backdrop mask transparency */
    @media not -moz-pref("uc.flex.browser-wallpaper-enabled") {
        --uc-browser-mica-transparency: 0.25;
        --uc-urlbar-backdrop-transparency: 0.75;
        --uc-menupopup-backdrop-transparency: 0.4;
        @media -moz-pref("uc.flex.browser-mica-transparency-level", 0) {
            --uc-browser-mica-transparency: 0.6;
            --uc-urlbar-backdrop-transparency: 0.95;
            --uc-menupopup-backdrop-transparency: 0.75;
        }
        @media -moz-pref("uc.flex.browser-mica-transparency-level", 1) {
            --uc-browser-mica-transparency: 0.35;
            --uc-urlbar-backdrop-transparency: 0.85;
            --uc-menupopup-backdrop-transparency: 0.5;
        }
        @media -moz-pref("uc.flex.browser-mica-transparency-level", 3) {
            --uc-browser-mica-transparency: 0.2;
            --uc-urlbar-backdrop-transparency: 0.7;
            --uc-menupopup-backdrop-transparency: 0.35;
        }
        @media -moz-pref("uc.flex.browser-mica-transparency-level", 4) {
            --uc-browser-mica-transparency: 0;
            --uc-urlbar-backdrop-transparency: 0.5;
            --uc-menupopup-backdrop-transparency: 0.15;
        }
    }

    /* Custom browser wallpaper background */
    --uc-browser-wallpaper: url("../icons/wallpaper/main-image-1.jpg"); /* Wallpaper image path */
    @media -moz-pref("uc.flex.browser-wallpaper-index", 0) {
        --uc-browser-wallpaper: none;
    }
    @media -moz-pref("uc.flex.browser-wallpaper-index", 2) {
        --uc-browser-wallpaper: url("../icons/wallpaper/main-image-2.jpg");
    }
    @media -moz-pref("uc.flex.browser-wallpaper-index", 3) {
        --uc-browser-wallpaper: url("../icons/wallpaper/main-image-3.jpg");
    }
    @media -moz-pref("uc.flex.browser-wallpaper-index", 4) {
        --uc-browser-wallpaper: url("../icons/wallpaper/main-image-4.jpg");
    }
    @media -moz-pref("uc.flex.browser-wallpaper-index", 5) {
        --uc-browser-wallpaper: url("../icons/wallpaper/main-image-5.jpg");
    }
    @media -moz-pref("uc.flex.browser-wallpaper-index", 6) {
        --uc-browser-wallpaper: url("../icons/wallpaper/main-image-6.jpg");
    }
    @media -moz-pref("uc.flex.browser-wallpaper-index", 7) {
        --uc-browser-wallpaper: url("../icons/wallpaper/main-image-7.jpg");
    }
    @media -moz-pref("uc.flex.browser-wallpaper-index", 8) {
        --uc-browser-wallpaper: url("../icons/wallpaper/main-image-8.jpg");
    }
    @media -moz-pref("uc.flex.browser-wallpaper-index", 9) {
        --uc-browser-wallpaper: url("../icons/wallpaper/main-image-9.jpg");
    }

    @media -moz-pref("uc.flex.browser-wallpaper-enabled") {
        --uc-browser-wallpaper-contrast-offset: 0%; /* Default contrast level offset for wallpaper */
        @media -moz-pref("uc.flex.browser-wallpaper-contrast-level", 0) {
            --uc-browser-wallpaper-contrast-offset: -9%;
        }
        @media -moz-pref("uc.flex.browser-wallpaper-contrast-level", 1) {
            --uc-browser-wallpaper-contrast-offset: -4.5%;
        }
        @media -moz-pref("uc.flex.browser-wallpaper-contrast-level", 3) {
            --uc-browser-wallpaper-contrast-offset: 4.5%;
        }
        @media -moz-pref("uc.flex.browser-wallpaper-contrast-level", 4) {
            --uc-browser-wallpaper-contrast-offset: 9%;
        }
        --uc-browser-wallpaper-contrast: calc(
            82% + var(--uc-browser-wallpaper-contrast-offset)
        ); /* Base wallpaper contrast value */

        --uc-browser-wallpaper-dark-mask: 0, 0, 0;
        --uc-browser-wallpaper-light-mask: 255, 255, 255;
        --uc-browser-wallpaper-transparency: 0.37; /* Default wallpaper mask transparency (lower = more visible) */
        @media (prefers-color-scheme: light), (-moz-content-prefers-color-scheme: light) {
            --uc-browser-wallpaper-transparency: 0.62;
        }
        --uc-urlbar-backdrop-transparency: 0.75;
        --uc-menupopup-backdrop-transparency: 0.4;

        @media -moz-pref("uc.flex.browser-wallpaper-transparency-level", 0) {
            --uc-browser-wallpaper-transparency: 0.69;
            --uc-browser-wallpaper-contrast: calc(91% + var(--uc-browser-wallpaper-contrast-offset));
            @media (prefers-color-scheme: light), (-moz-content-prefers-color-scheme: light) {
                --uc-browser-wallpaper-transparency: 0.8;
            }
            --uc-urlbar-backdrop-transparency: 0.95;
            --uc-menupopup-backdrop-transparency: 0.75;
        }
        @media -moz-pref("uc.flex.browser-wallpaper-transparency-level", 1) {
            --uc-browser-wallpaper-transparency: 0.44;
            --uc-browser-wallpaper-contrast: calc(85% + var(--uc-browser-wallpaper-contrast-offset));
            @media (prefers-color-scheme: light), (-moz-content-prefers-color-scheme: light) {
                --uc-browser-wallpaper-transparency: 0.67;
            }
            --uc-urlbar-backdrop-transparency: 0.85;
            --uc-menupopup-backdrop-transparency: 0.5;
        }
        @media -moz-pref("uc.flex.browser-wallpaper-transparency-level", 3) {
            --uc-browser-wallpaper-transparency: 0.31;
            --uc-browser-wallpaper-contrast: calc(79% + var(--uc-browser-wallpaper-contrast-offset));
            @media (prefers-color-scheme: light), (-moz-content-prefers-color-scheme: light) {
                --uc-browser-wallpaper-transparency: 0.58;
            }
            --uc-urlbar-backdrop-transparency: 0.7;
            --uc-menupopup-backdrop-transparency: 0.35;
        }
        @media -moz-pref("uc.flex.browser-wallpaper-transparency-level", 4) {
            --uc-browser-wallpaper-transparency: 0.08;
            --uc-browser-wallpaper-contrast: calc(73% + var(--uc-browser-wallpaper-contrast-offset));
            @media (prefers-color-scheme: light), (-moz-content-prefers-color-scheme: light) {
                --uc-browser-wallpaper-transparency: 0.49;
            }
            --uc-urlbar-backdrop-transparency: 0.5;
            --uc-menupopup-backdrop-transparency: 0.15;
        }

        @media -moz-pref("uc.flex.browser-wallpaper-acrylic-disabled") {
            --uc-browser-wallpaper-dark-mask: 30, 30, 47;
            --uc-browser-wallpaper-light-mask: 249, 249, 251;
            --uc-browser-wallpaper-transparency: 0.74;
            @media -moz-pref("uc.flex.browser-wallpaper-transparency-level", 0) {
                --uc-browser-wallpaper-transparency: 0.98;
            }
            @media -moz-pref("uc.flex.browser-wallpaper-transparency-level", 1) {
                --uc-browser-wallpaper-transparency: 0.9;
            }
            @media -moz-pref("uc.flex.browser-wallpaper-transparency-level", 3) {
                --uc-browser-wallpaper-transparency: 0.64;
            }
            @media -moz-pref("uc.flex.browser-wallpaper-transparency-level", 4) {
                --uc-browser-wallpaper-transparency: 0;
            }
        }
    }

    /** 
     * These variables must stay in sync with the identical ones in uc-sidebery.css.
     * If you copy and modify them in uc-user-settings.css, be sure to also update
     * the corresponding variables in uc-custom-content.css to keep both sides consistent. 
     */
    /* Sidebar expand/collapse animation settings */
    --uc-autohide-transition-type: ease-in-out; /* Easing type for sidebar collapsing animation */
    --uc-autohide-transition-duration: 55ms; /* Duration of sidebar collapsing animation */
    --uc-hover-transition-duration: 115ms; /* Duration of sidebar expanding animation */
    --uc-autohide-sidebar-delay: 28ms; /* Delay before collapsing the sidebar */
    --uc-hover-sidebar-delay: 80ms; /* Delay before expanding the sidebar */
    --uc-horizontal-tab-width-transition-duration: 200ms; /* Duration of width transition for horizontal tab */

    /* Speed up sidebar expand/collapse animation */
    @media -moz-pref("uc.flex.sidebery-fast-hover-expand") {
        --uc-hover-transition-duration: 100ms;
        --uc-autohide-sidebar-delay: 28ms;
        --uc-hover-sidebar-delay: 1ms;
        --uc-horizontal-tab-width-transition-duration: 150ms;
    }
    /* Slow down sidebar expand/collapse animation */
    @media -moz-pref("uc.flex.sidebery-slow-hover-expand") {
        --uc-autohide-sidebar-delay: 28ms;
        --uc-hover-sidebar-delay: 350ms;
        --uc-hover-toolbar-delay: 200ms;
        --uc-horizontal-tab-width-transition-duration: 250ms;
    }

    /* Size and color of macOS-style window control buttons */
    @media not -moz-pref("uc.flex.revert-to-original-window-controls") {
        --uc-osx-ctrls-size: 15px;
    }
    --uc-osx-ctrls-close-fill: #f25056;
    --uc-osx-ctrls-maximize-fill: #39ea49;
    /*
    --uc-osx-ctrls-maximize-restore-fill: #39ea49;
    */
    --uc-osx-ctrls-minimize-fill: hsl(44, 95%, 63%);
    --uc-osx-ctrls-close-stroke: #9f1d2b;
    --uc-osx-ctrls-maximize-stroke: #0b7407;
    --uc-osx-ctrls-maximize-restore-stroke: #0b7407;
    --uc-osx-ctrls-minimize-stroke: hsl(32, 62%, 38%);

    /* Vertical spacing between items in the Firefox app menu (hamburger menu), bookmarks menu, and context menus. */
    --uc-app-menu-item-padding-block: 4px;
    --uc-menu-item-padding-block: 2px;
    --uc-content-area-context-menu-item-padding-block: 2px;
    --uc-appMenu-zoom-controls-x-offset: 0px;
    @media -moz-pref("uc.flex.menu-item-spacing", "2"), -moz-pref("uc.flex.menu-item-spacing", "medium") {
        --uc-app-menu-item-padding-block: 6px;
        --uc-menu-item-padding-block: 4px;
        --uc-content-area-context-menu-item-padding-block: 3px;
        --uc-appMenu-zoom-controls-x-offset: 2px;
    }
    @media -moz-pref("uc.flex.menu-item-spacing", "3"), -moz-pref("uc.flex.menu-item-spacing", "large") {
        --uc-app-menu-item-padding-block: 8px;
        --uc-menu-item-padding-block: 8px;
        --uc-content-area-context-menu-item-padding-block: 8px;
        --uc-appMenu-zoom-controls-x-offset: 4px;
    }

    /* Max visible rows in native vertical pinned tabs (before scrolling) */
    --uc-vt-pinned-tab-max-rows: 4;
    @media -moz-pref("uc.flex.max-visible-vertical-pinned-tabs", 2) {
        --uc-vt-pinned-tab-max-rows: 2;
    }
    @media -moz-pref("uc.flex.max-visible-vertical-pinned-tabs", 3) {
        --uc-vt-pinned-tab-max-rows: 3;
    }
    @media -moz-pref("uc.flex.max-visible-vertical-pinned-tabs", 5) {
        --uc-vt-pinned-tab-max-rows: 5;
    }
    @media -moz-pref("uc.flex.max-visible-vertical-pinned-tabs", 6) {
        --uc-vt-pinned-tab-max-rows: 6;
    }
    @media -moz-pref("uc.flex.max-visible-vertical-pinned-tabs", 7) {
        --uc-vt-pinned-tab-max-rows: 7;
    }
    @media -moz-pref("uc.flex.max-visible-vertical-pinned-tabs", 8) {
        --uc-vt-pinned-tab-max-rows: 8;
    }

    /* Tabs per row for native pinned tabs and Sidebery (controlled by per-tab percentage width) */
    --uc-vt-pinned-tab-max-columns: 20%;
    --uc-ht-pinned-tab-max-columns: 10;
    @media -moz-pref("uc.flex.max-visible-horizontal-pinned-tabs", 4) {
        --uc-vt-pinned-tab-max-columns: 25%;
        --uc-ht-pinned-tab-max-columns: 8;
    }
    @media -moz-pref("uc.flex.max-visible-horizontal-pinned-tabs", 3) {
        --uc-vt-pinned-tab-max-columns: 33.333%;
        --uc-ht-pinned-tab-max-columns: 6;
    }
    @media -moz-pref("uc.flex.max-visible-horizontal-pinned-tabs", 2) {
        --uc-vt-pinned-tab-max-columns: 50%;
        --uc-ht-pinned-tab-max-columns: 4;
    }
    @media -moz-pref("uc.flex.max-visible-horizontal-pinned-tabs", 1) {
        --uc-vt-pinned-tab-max-columns: 100%;
        --uc-ht-pinned-tab-max-columns: 2;
    }

    /* Border color for pinned tabs */
    --uc-vt-pinned-tab-border-color: light-dark(rgba(0, 0, 0, 0.22), rgba(172, 112, 255, 0.7));
    /* Border color for unloaded pinned tabs */
    --uc-vt-pinned-tab-unloaded-border-color: light-dark(rgba(0, 0, 0, 0.1), rgba(172, 112, 255, 0.28));
    /* Background color for the active tab */
    --uc-vt-active-tab-bgcolor: light-dark(#ea4c895e, #9651ff80);
    /* Inner border shadow (outline) for the active tab */
    --uc-vt-active-tab-border-shadow: 0 0 0 1px light-dark(rgba(0, 0, 0, 0.6), rgba(255, 255, 255, 0.467));
    /* Drop shadow beneath the active tab */
    --uc-vt-active-tab-drop-shadow: 0 1px 3px -1px light-dark(rgba(0, 0, 0, 0.196), rgba(0, 0, 0, 0.212));

    /* Layout of extension icons in the unified extensions panel */
    --uc-uei-icon-size: 22px; /* Size of extension icons */
    --uc-number-of-extensions-in-a-row: 4; /* Number of extension icons per row */

    /* Trigger sensitivity for fully hidden Sidebery sidebar */
    /**
     * Controls how close the cursor must be to the window edge to trigger the sidebar
     * when `uc.flex.fully-hide-sidebery` is enabled and the window is not maximized.
     * A larger value increases the trigger distance, allowing activation from farther away,
     * but may interfere with webpage interaction.
     * A smaller value reduces accidental triggers, but may make it difficult
     * to reveal the sidebar without entering resize mode.
     */
    --uc-sidebar-hover-trigger-width: 22px;
    &:not([sizemode="normal"]) {
        --uc-sidebar-hover-trigger-width: 1px;
    }

    /* Trigger sensitivity for fully hidden top toolbar */
    /**
     * Controls how close the cursor must be to the top edge to trigger the toolbar
     * when `uc.flex.fully-hide-toolbox` is enabled.
     * A lower angle increases the trigger distance, allowing activation from farther away,
     * but may interfere with webpage interaction.
     * A higher angle reduces accidental triggers, requiring more precise cursor placement.
     */
    --uc-toolbox-rotation: 82deg; /* Toolbox rotation angle (lower value recommended for macOS) */
    &[sizemode="normal"] {
        --uc-toolbox-rotation: 75deg;
    }
    &[sizemode="maximized"] {
        --uc-toolbox-rotation: 88.5deg;
    }

    /* Auto-hide delay for bookmarks toolbar and navigator toolbox */
    --uc-autohide-toolbar-duration: 80ms; /* Duration of the bookmarks toolbar hide animation */
    --uc-autohide-toolbar-delay: 200ms; /* Delay before hiding the bookmarks toolbar */
    --uc-hover-toolbar-delay: 80ms; /* Delay before showing the bookmarks toolbar */
    --uc-autohide-toolbox-delay: 200ms; /* Delay before hiding the navigator toolbox */

    /* Auto-hide timing for horizontal tabs */
    /**
     * If you're using Firefox versions earlier than 130, 
     * starting from FlexFox v1.0.0, the update to autohide_tabstoolbar_v2.css 
     * may cause vertical shifting when switching between New Tab and regular tabs 
     * while Sidebery is disabled and "Only Show Bookmarks Toolbar on New Tab" is enabled. 
     * To eliminate this issue, set --uc-tabs-hide-animation-duration to 0ms and 
     *                                 --uc-tabs-hide-animation-delay to 1ms. 
     */
    /*
    --uc-tabs-hide-animation-duration: 48ms; \/* Duration of horizontal tab hide animation *\/
    --uc-tabs-hide-animation-delay: 200ms; \/* Delay before hiding horizontal tabs *\/
    */
    /* 🔼 End of layout and highlight definitions */
}

/* ════════════════════════════════════════════════════════════════════
   ⚙️ SYSTEM LOGIC VARIABLES — DO NOT EDIT

   These variables are dynamically assigned based on complex conditions,
   using nested @media -moz-pref() queries and advanced selectors.

   They are used internally by the stylesheet to switch layout behavior
   based on the current environment and user settings.

   🚫 Do not modify this section unless you understand the logic fully.
════════════════════════════════════════════════════════════════════ */
:root {
    /* ════════════════════════════════════════════════════════════════════
    ██╗███╗   ██╗██╗████████╗██╗ █████╗ ██╗     ██╗███████╗ █████╗ ████████╗██╗ ██████╗ ███╗   ██╗
    ██║████╗  ██║██║╚══██╔══╝██║██╔══██╗██║     ██║╚══███╔╝██╔══██╗╚══██╔══╝██║██╔═══██╗████╗  ██║
    ██║██╔██╗ ██║██║   ██║   ██║███████║██║     ██║  ███╔╝ ███████║   ██║   ██║██║   ██║██╔██╗ ██║
    ██║██║╚██╗██║██║   ██║   ██║██╔══██║██║     ██║ ███╔╝  ██╔══██║   ██║   ██║██║   ██║██║╚██╗██║
    ██║██║ ╚████║██║   ██║   ██║██║  ██║███████╗██║███████╗██║  ██║   ██║   ██║╚██████╔╝██║ ╚████║
    ╚═╝╚═╝  ╚═══╝╚═╝   ╚═╝   ╚═╝╚═╝  ╚═╝╚══════╝╚═╝╚══════╝╚═╝  ╚═╝   ╚═╝   ╚═╝ ╚═════╝ ╚═╝  ╚═══╝
                                                                                                  
       🧪 INITIAL VARIABLE DEFINITIONS
    
       Sets fallback values to prevent undefined vars and layout issues.
       Includes base sizes used in later layout calculations.

           Originally, condition A was handled via a @media query.
           Now that [titlepreface*="A"] offers equivalent logic,
           we need to ensure both mechanisms (@media A and [titlepreface*="A"])
           apply the same styles. The conversion pattern is as follows:
        
           When the original is:
             @media A and B {
                 ...
             }
        
        +  Add a new block below:
        +  @media (not A) and B {
        +      [titlepreface*="A"] {
        +          ...
        +      }
        +  }
        
           -------------------------------------------------------
        
           For negated conditions:
        
           When the original is:
             @media not (A or B) {
                 ...
             }
        
        +  Simply insert this inside the existing block:
        +      :not([titlepreface*="A"]) {
                   ...
        +      }
        
           Summary:
           1. If the original rule is @media not A, no duplication is needed—
              just wrap the existing rules with :not([titlepreface*="A"]).
           2. If the original rule is @media A, duplicate the block with the
              adjusted @media condition and nest [titlepreface*="A"] inside it.

    ════════════════════════════════════════════════════════════════════ */
    /* 🔽 Begin initializing block */
    --uc-toolbar-bgcolor: var(--uc-bgcolor); /* Internal fallback; must match --uc-bgcolor */
    --uc-sidebar-stripe-width: var(--uc-sidebar-width); /* Internal reference; must match --uc-sidebar-width */

    /* Initial value: shift nav bar left to make room for window control buttons */
    /*
    --uc-nav-bar-padding-right: 0px;
    */
    --uc-sidebar-button-offset: 0px;
    /* If the sidebar button is the last item in the nav bar, leave room for it. */
    @media not -moz-pref("sidebar.position_start") {
        #nav-bar:has(> #nav-bar-customization-target > #sidebar-button:last-child) {
            --uc-sidebar-button-offset: var(--uc-sidebar-stripe-width, 0px);
            /* In horizontal tab mode, shift the sidebar button only when Sidebery is active */
            @media not -moz-pref("sidebar.verticalTabs") {
                --uc-sidebar-button-offset: var(--uc-sb-sidebar-button-offset, 0px);
            }
        }
    }

    /* When native vertical tabs are enabled, window control spacing is not needed. */
    /*
    @media -moz-pref("sidebar.verticalTabs") {
        \/* Set the variable under #navigator-toolbox to override the Sidebery-active value on :root, avoiding !important. *\/
        #navigator-toolbox {
            --uc-nav-bar-padding-right: 0px;
        }
    }
    */
    /* When the menu bar is enabled, window control spacing is not needed. */
    /*
    &:not([inFullscreen]) {
        \/* !v143 *\/
        #toolbar-menubar:not([autohide="true"]):not([autohide=""]) ~ #nav-bar {
            --uc-nav-bar-padding-right: 0px;
        }
        #toolbar-menubar:where([autohide="true"], [autohide=""]):not([inactive="true"]) ~ #nav-bar {
            --uc-nav-bar-padding-right: 0px;
        }
    }
    */

    /* Shift the nav bar to align the first item with the vertical tabs */
    --uc-nav-bar-padding-left: 6px;
    &[inFullscreen] {
        --uc-nav-bar-padding-left: 5px;
    }

    /* Add right-side spacing after the first item to align nearby items with the vertical tabs */
    --uc-nav-bar-first-child-padding-right: 6px;
    --uc-nav-bar-second-bookmarks-padding-left: 6px;
    /* When vertical tabs are not enabled, the extra spacing above is unnecessary */
    @media -moz-pref("uc.flex.disable-nav-bar-first-item-right-padding"),
        -moz-pref("uc.flex.fully-hide-toolbox"),
        -moz-pref("uc.flex.fully-hide-sidebery"),
        not -moz-pref("sidebar.verticalTabs") {
        --uc-nav-bar-first-child-padding-right: 0px;
    }
    @media not (-moz-pref("uc.flex.fully-hide-toolbox") or -moz-pref("uc.flex.fully-hide-sidebery")) {
        &:is([titlepreface*="\200b "], [titlepreface*="\200c "], [titlepreface*="\200d "]) {
            --uc-nav-bar-first-child-padding-right: 0px;
        }
    }

    /* ════════════════════════════════════════════════════════════════════
        🟦 Rounded clipping for web content
    ════════════════════════════════════════════════════════════════════ */
    /**
     * Clips background bleed at rounded corners;
     * slightly larger than --uc-web-content-radius to push the clipping edge further inward.
     */
    --uc-web-content-radius-clip: calc(var(--uc-web-content-radius) + 1px);
    /* Outset clip for tab box shadows when Mica is enabled */
    --uc-web-content-margin-outset-clip-mica: calc(-1 * var(--uc-web-content-margin));

    /* Add margin to the web content area */
    @media -moz-pref("uc.flex.enable-rounded-web-content") {
        #tabbrowser-tabbox {
            --uc-web-content-margin-top: 0;
            --uc-web-content-margin-side: 0;
            @media -moz-pref("uc.flex.fully-hide-toolbox") {
                --uc-web-content-margin-top: var(--uc-web-content-margin);
            }
            @media not -moz-pref("uc.flex.fully-hide-toolbox") {
                :root[titlepreface*="\200b "] & {
                    --uc-web-content-margin-top: var(--uc-web-content-margin);
                }
            }
            @media -moz-pref("uc.flex.fully-hide-sidebery") {
                --uc-web-content-margin-side: var(--uc-web-content-margin);
                /* Apply margin when Sidebery is active and sidebar is collapsed; not needed for native vertical tabs */
                @media -moz-pref("sidebar.verticalTabs") {
                    &:not([sidebar-launcher-expanded]) {
                        --uc-web-content-margin-side: var(--uc-sb-web-content-margin-side, 0);
                    }
                }
                @media -moz-pref("sidebar.visibility", "expand-on-hover") {
                    --uc-web-content-margin-side: var(--uc-sb-web-content-margin-side, 0);
                }
            }
            @media not -moz-pref("uc.flex.fully-hide-sidebery") {
                :root[titlepreface*="\200c "] & {
                    --uc-web-content-margin-side: var(--uc-web-content-margin);
                    @media -moz-pref("sidebar.verticalTabs") {
                        &:not([sidebar-launcher-expanded]) {
                            --uc-web-content-margin-side: var(--uc-sb-web-content-margin-side, 0);
                        }
                    }
                    @media -moz-pref("sidebar.visibility", "expand-on-hover") {
                        --uc-web-content-margin-side: var(--uc-sb-web-content-margin-side, 0);
                    }
                }
            }
            @media -moz-pref("sidebar.visibility", "hide-sidebar") {
                @media not -moz-pref("sidebar.revamp") {
                    &:not([sidebar-panel-open]) {
                        --uc-web-content-margin-side: var(--uc-web-content-margin);
                    }
                }
                @media -moz-pref("sidebar.revamp") {
                    &:not([sidebar-panel-open], [sidebar-shown]) {
                        --uc-web-content-margin-side: var(--uc-web-content-margin);
                    }
                }
            }
            --uc-web-content-margin-box: var(--uc-web-content-margin-top) var(--uc-web-content-margin)
                var(--uc-web-content-margin) var(--uc-web-content-margin-side);
            &[sidebar-positionend] {
                --uc-web-content-margin-box: var(--uc-web-content-margin-top) var(--uc-web-content-margin-side)
                    var(--uc-web-content-margin) var(--uc-web-content-margin);
            }
        }
    }

    /* Toolbar sizing */
    --uc-tabs-toolbar-height: calc(2 * var(--tab-block-margin) + var(--tab-min-height));
    #urlbar-container,
    #urlbar {
        --urlbar-height: 32px !important;
        --urlbar-container-height: 40px !important;
        @media -moz-pref("uc.flex.increase-navbar-height") {
            --urlbar-container-height: 43px !important;
        }
    }

    --uc-nav-bar-height: 40px;
    --uc-titlebar-buttonbox-height: 35px;
    @media -moz-pref("uc.flex.increase-navbar-height") {
        --uc-nav-bar-height: 43px;
        --uc-titlebar-buttonbox-height: 38px;
    }

    /* Position of the sidebar button icon */
    --uc-sidebar-button-bg-pos: 10px 11px;
    --uc-sidebar-button-bg-pos-first: 13px 10px;
    --uc-sidebar-button-bg-pos-first-fs: 11px 10px;
    --uc-sidebar-button-bg-pos-last: 8.5px 1.5px;
    --uc-sidebar-button-height-last: 23px;
    @media -moz-pref("uc.flex.increase-navbar-height") {
        --uc-sidebar-button-bg-pos: 10px 12px;
        --uc-sidebar-button-bg-pos-first: 13px 12px;
        --uc-sidebar-button-bg-pos-first-fs: 11px 12px;
        --uc-sidebar-button-bg-pos-last: 8.5px 3px;
        --uc-sidebar-button-height-last: 26px;
    }
    /* Position of the sidebar button icon in horizontal tab mode */
    @media not -moz-pref("sidebar.verticalTabs") {
        --uc-sidebar-button-bg-pos-first: 14px 11px;
        --uc-sidebar-button-bg-pos-first-fs: 12px 11px;
        --uc-sidebar-button-bg-pos-last: 10px 11px;
        @media -moz-pref("uc.flex.increase-navbar-height") {
            --uc-sidebar-button-bg-pos-first: 14px 13px;
            --uc-sidebar-button-bg-pos-first-fs: 12px 13px;
            --uc-sidebar-button-bg-pos-last: 10px 12px;
        }
    }

    /* Initial display and positioning values for the window controls when auto-hide navbar is enabled */
    @media not -moz-pref("sidebar.verticalTabs") {
        &:not([customizing]) {
            @media -moz-pref("uc.flex.auto-hide-navbar-and-keep-horizontal-tabs") or -moz-pref("uc.flex.restore-window-controls-on-tabbar") {
                --uc-tabs-toolbar-windows-controls-display: flex;
                --uc-navbar-windows-controls-display: none;
            }
        }
        --uc-nav-bar-padding-right: 0px;
        /*
        @media not -moz-pref("uc.flex.auto-hide-window-controls") {
            &:has(#toolbar-menubar[inactive="true"]) {
                --uc-nav-bar-padding-right: 104px;
            }
        }
        @media -moz-pref("uc.flex.auto-hide-window-controls") {
            --uc-nav-bar-padding-right: 0px;
            &:has(#TabsToolbar > .titlebar-buttonbox-container:hover) {
                --uc-nav-bar-padding-right: 104px;
            }
        }
        */
    }

    --uc-bm-height: 24px; /* Adjust as needed if other toolbar buttons are added */
    --uc-bm-padding: 4px; /* Vertical padding applied to bookmarks */
    &[uidensity="touch"] {
        --uc-bm-padding: 7px;
    }
    /*
    --bookmarks-toolbar-overlapping-browser-height: calc(var(--uc-bm-height) + 2 * var(--uc-bm-padding)) !important;
    */
    --uc-bm-padding-box-height: calc(var(--uc-bm-height) + 2 * var(--uc-bm-padding));
    @media -moz-pref("uc.flex.disable-bookmarks-autohide") and (not -moz-pref("uc.flex.fully-hide-toolbox")) {
        &:not([inFullscreen], [titlepreface*="\200b "], [titlepreface*="\200d "]) {
            --uc-bm-disable-autohide-offset: calc(-1 * (var(--uc-bm-padding-box-height)));
        }
    }
    @media -moz-pref("uc.flex.sidebery-allow-resizable-width") and (not -moz-pref("uc.flex.fully-hide-sidebery")) {
        &:not([inFullscreen], [titlepreface*="\200c "], [titlepreface*="\200d "]) {
            @media -moz-pref("uc.flex.disable-bookmarks-autohide") {
                --uc-bm-disable-autohide-offset: 0px;
            }
        }
    }

    /* Initial values for variables required by uc-tabs-bar.css (autohide horizontal tabs) */
    --uc-autohide-bottom: calc(0px - var(--uc-tabs-toolbar-height));
    --uc-autohide-navigator-bottom: var(--uc-autohide-bottom);
    --uc-autohide-tabstoolbar-bottom: 0px;
    --uc-navbar-transform: calc(-1 * var(--uc-nav-bar-height));
    --uc-navbar-offset-y: calc(-1 * var(--uc-nav-bar-height));
    /*
    --uc-autohide-navigator-delay: 0s;
    */
    --uc-autohide-tabstoolbar-visibility: visible;
    /* Default delay for visibility (18ms) and margin-bottom (0ms) transitions */
    /*
    --uc-autohide-tabstoolbar-delay: 18ms, 0ms;
    */

    /* Translucent background color for the #searchbar input field */
    --uc-urlbar-bg-transparent: color-mix(in srgb, var(--uc-urlbar-bg) 50%, transparent);

    /* Default background colors for the identity button and findbar when a theme is active */
    &[lwtheme] {
        --uc-identity-btn-bgcolor: inherit;
        --uc-findbar-bgcolor: var(--lwt-accent-color-inactive, var(--lwt-accent-color));
    }

    /* Override the default background color with a custom value when add-on color changes are not allowed */
    @media not (-moz-pref("uc.flex.allow-addons-to-change-toolbar-color") or -moz-pref("uc.flex.browser-wallpaper-enabled")) {
        @media -moz-pref("extensions.activeThemeID", "default-theme@mozilla.org") and (not -moz-pref("widget.windows.mica")),
            -moz-pref("extensions.activeThemeID", "firefox-compact-light@mozilla.org"),
            -moz-pref("extensions.activeThemeID", "firefox-compact-dark@mozilla.org") {
            &:not([lwtheme-image], [style*="--lwt-additional-images"]) {
                --uc-identity-btn-bgcolor: var(--uc-toolbar-bgcolor);
                --uc-findbar-bgcolor: var(--uc-toolbar-bgcolor);
                --uc-sidebar-header-bgcolor: var(--uc-toolbar-bgcolor);
            }
        }
    }

    /* Adjust findbar position to avoid being overlapped when top toolbar height changes */
    --uc-findbar-y-offset: calc(var(--uc-bm-padding) + var(--uc-bm-height) - 1.5px);
    &[inFullscreen] {
        --uc-findbar-y-offset: calc(var(--uc-bm-padding) + var(--uc-bm-height) + var(--uc-nav-bar-height) - 1.5px);
    }
    &:not([inFullscreen]) {
        @media -moz-pref("uc.flex.fully-hide-toolbox") {
            --uc-findbar-y-offset: calc(var(--uc-bm-padding) + var(--uc-bm-height) + var(--uc-nav-bar-height) - 9.5px);
        }
        @media not -moz-pref("uc.flex.fully-hide-toolbox") {
            &:is([titlepreface*="\200b "], [titlepreface*="\200d "]) {
                --uc-findbar-y-offset: calc(
                    var(--uc-bm-padding) + var(--uc-bm-height) + var(--uc-nav-bar-height) - 9.5px
                );
            }
        }
        @media -moz-pref("uc.flex.disable-bookmarks-autohide") {
            &:not([customizing]) {
                /* Recalculate the findbar position if "uc.flex.disable-bookmarks-autohide" is enabled */
                --uc-findbar-y-offset: calc(-1 * var(--uc-bm-padding) - 1.5px);
            }
        }
    }

    /* ════════════════════════════════════════════════════════════════════
        ↕️ Expand/collapse transition animation
    ════════════════════════════════════════════════════════════════════ */
    /* Transition properties for toolbar autohide */
    --uc-navigator-z-index: 0;
    /* Add a delay to z-index transitions to avoid flickering caused by unstable hover state inside #navigator-toolbox. */
    /** 
     * Although z-index is listed as an animatable integer on MDN,
     * Firefox treats it as a discrete property that requires 'allow-discrete'
     * for transition delays to take effect.
     * To avoid ambiguity, we still apply a manual delay equal to other
     * properties' delay + duration, ensuring the change happens after animation ends.
     */
    --uc-autohide-tabs-toolbar-transition:
        visibility 0ms linear var(--uc-autohide-toolbar-delay),
        margin-bottom var(--uc-autohide-toolbar-duration) ease-out var(--uc-autohide-toolbar-delay);
    --uc-autohide-navigator-transition:
        background-color var(--inactive-window-transition),
        margin-bottom var(--uc-autohide-toolbar-duration) ease-out var(--uc-autohide-toolbar-delay),
        z-index 0ms linear calc(var(--uc-autohide-toolbar-delay) + var(--uc-autohide-toolbar-duration) + 10ms)
            allow-discrete;
    --uc-autohide-navbar-transition:
        transform var(--uc-autohide-toolbar-duration) ease var(--uc-autohide-toolbar-delay),
        opacity var(--uc-autohide-toolbar-duration) ease var(--uc-autohide-toolbar-delay);
    --uc-autohide-personal-toolbar-transition:
        opacity var(--uc-autohide-toolbar-duration) linear var(--uc-autohide-toolbar-delay),
        transform var(--uc-autohide-toolbar-duration) linear var(--uc-autohide-toolbar-delay);
    --uc-autohide-tabs-toolbar-windows-controls-transition:
        margin-block-start var(--uc-autohide-toolbar-duration) ease var(--uc-autohide-toolbar-delay),
        margin-inline-end 0s ease var(--uc-autohide-toolbar-delay),
        opacity var(--uc-autohide-toolbar-duration) ease var(--uc-autohide-toolbar-delay);

    /* Unified autohide transition timing for the toolbar */
    @media -moz-pref("extensions.activeThemeID", "default-theme@mozilla.org") and -moz-pref("widget.windows.mica"),
        -moz-pref("uc.flex.sidebery-apply-expand-speed-to-toolbars"),
        -moz-pref("uc.flex.browser-wallpaper-enabled") {
        --uc-autohide-tabs-toolbar-transition:
            visibility 0ms linear var(--uc-autohide-sidebar-delay),
            margin-bottom var(--uc-autohide-transition-duration) var(--uc-autohide-transition-type)
                var(--uc-autohide-sidebar-delay);
        --uc-autohide-navigator-transition:
            background-color var(--inactive-window-transition),
            margin-bottom var(--uc-autohide-transition-duration) var(--uc-autohide-transition-type)
                var(--uc-autohide-sidebar-delay),
            z-index 0ms linear calc(var(--uc-autohide-sidebar-delay) + var(--uc-autohide-transition-duration) + 10ms)
                allow-discrete;
        --uc-autohide-navbar-transition:
            transform var(--uc-autohide-transition-duration) var(--uc-autohide-transition-type)
                var(--uc-autohide-sidebar-delay),
            opacity var(--uc-autohide-transition-duration) var(--uc-autohide-transition-type)
                var(--uc-autohide-sidebar-delay);
        --uc-autohide-personal-toolbar-transition:
            opacity var(--uc-autohide-transition-duration) var(--uc-autohide-transition-type)
                var(--uc-autohide-sidebar-delay),
            transform var(--uc-autohide-transition-duration) var(--uc-autohide-transition-type)
                var(--uc-autohide-sidebar-delay);
        --uc-autohide-tabs-toolbar-windows-controls-transition:
            margin-block-start var(--uc-autohide-transition-duration) var(--uc-autohide-transition-type)
                var(--uc-autohide-sidebar-delay),
            margin-inline-end 0s var(--uc-autohide-transition-type) var(--uc-autohide-sidebar-delay),
            opacity var(--uc-autohide-transition-duration) var(--uc-autohide-transition-type)
                var(--uc-autohide-sidebar-delay);

        /**/
        --uc-tabbox-clip-path-start: inset(
            var(--uc-web-content-margin-outset-clip-mica) 0 0 var(--uc-web-content-margin-outset-clip-mica)
        );
        --uc-tabbox-clip-path-end: inset(
            var(--uc-web-content-margin-outset-clip-mica) var(--uc-web-content-margin-outset-clip-mica) 0 0
        );
        --uc-tabbox-clip-path-transition: clip-path var(--uc-autohide-transition-duration)
            var(--uc-autohide-transition-type) var(--uc-autohide-sidebar-delay);

        /**/
        --uc-vt-sidebox-clip-path-start: inset(0 0 0 0);
        --uc-vt-sidebox-clip-path-end: inset(0 0 0 0);

        /* Extra delay is required when auto-hide navbar is enabled with window controls moved to the navbar, 
            to prevent flicker from unstable hover states */
        @media -moz-pref("uc.flex.auto-hide-navbar-and-keep-horizontal-tabs") and (not -moz-pref("sidebar.verticalTabs")) {
            @media not -moz-pref("uc.flex.restore-window-controls-on-tabbar") {
                --uc-autohide-tabs-toolbar-transition:
                    visibility 0ms linear calc(var(--uc-autohide-sidebar-delay) + 28ms),
                    margin-bottom var(--uc-autohide-transition-duration) var(--uc-autohide-transition-type)
                        calc(var(--uc-autohide-sidebar-delay) + 28ms);
                --uc-autohide-navigator-transition:
                    background-color var(--inactive-window-transition),
                    margin-bottom var(--uc-autohide-transition-duration) var(--uc-autohide-transition-type)
                        calc(var(--uc-autohide-sidebar-delay) + 28ms),
                    z-index 0ms linear
                        calc(var(--uc-autohide-sidebar-delay) + var(--uc-autohide-transition-duration) + 38ms)
                        allow-discrete;
                --uc-autohide-navbar-transition:
                    transform var(--uc-autohide-transition-duration) var(--uc-autohide-transition-type)
                        calc(var(--uc-autohide-sidebar-delay) + 28ms),
                    opacity var(--uc-autohide-transition-duration) var(--uc-autohide-transition-type)
                        calc(var(--uc-autohide-sidebar-delay) + 28ms);
                --uc-autohide-personal-toolbar-transition:
                    opacity var(--uc-autohide-transition-duration) var(--uc-autohide-transition-type)
                        calc(var(--uc-autohide-sidebar-delay) + 28ms),
                    transform var(--uc-autohide-transition-duration) var(--uc-autohide-transition-type)
                        calc(var(--uc-autohide-sidebar-delay) + 28ms);
                --uc-autohide-tabs-toolbar-windows-controls-transition:
                    margin-block-start var(--uc-autohide-transition-duration) var(--uc-autohide-transition-type)
                        calc(var(--uc-autohide-sidebar-delay) + 28ms),
                    margin-inline-end 0s var(--uc-autohide-transition-type)
                        calc(var(--uc-autohide-sidebar-delay) + 28ms),
                    opacity var(--uc-autohide-transition-duration) var(--uc-autohide-transition-type)
                        calc(var(--uc-autohide-sidebar-delay) + 28ms);

                --uc-tabbox-clip-path-transition: clip-path var(--uc-autohide-transition-duration)
                    var(--uc-autohide-transition-type) calc(var(--uc-autohide-sidebar-delay) + 28ms);
            }
        }
    }

    /* Transition properties for toolbar hover */
    --uc-hover-tabs-toolbar-transition:
        visibility 0ms linear var(--uc-hover-toolbar-delay),
        margin-bottom var(--uc-autohide-toolbar-duration) ease-out var(--uc-hover-toolbar-delay);
    --uc-hover-navigator-transition:
        background-color var(--inactive-window-transition),
        margin-bottom var(--uc-autohide-toolbar-duration) ease-out var(--uc-hover-toolbar-delay),
        z-index 0ms linear var(--uc-hover-toolbar-delay) allow-discrete;
    --uc-hover-navbar-transition:
        transform var(--uc-autohide-toolbar-duration) ease var(--uc-hover-toolbar-delay),
        opacity var(--uc-autohide-toolbar-duration) ease var(--uc-hover-toolbar-delay);
    --uc-hover-personal-toolbar-transition:
        opacity var(--uc-autohide-toolbar-duration) linear var(--uc-hover-toolbar-delay),
        transform var(--uc-autohide-toolbar-duration) linear var(--uc-hover-toolbar-delay);
    --uc-hover-tabs-toolbar-windows-controls-transition:
        margin-block-start var(--uc-autohide-toolbar-duration) ease var(--uc-hover-toolbar-delay),
        margin-inline-end 0s ease var(--uc-hover-toolbar-delay),
        opacity var(--uc-autohide-toolbar-duration) ease var(--uc-hover-toolbar-delay);

    /* Unified hover transition timing for the toolbar */
    @media -moz-pref("extensions.activeThemeID", "default-theme@mozilla.org") and -moz-pref("widget.windows.mica"),
        -moz-pref("uc.flex.sidebery-apply-expand-speed-to-toolbars"),
        -moz-pref("uc.flex.browser-wallpaper-enabled") {
        --uc-hover-tabs-toolbar-transition:
            visibility 0ms linear var(--uc-hover-sidebar-delay),
            margin-bottom var(--uc-hover-transition-duration) var(--uc-autohide-transition-type)
                var(--uc-hover-sidebar-delay);
        --uc-hover-navigator-transition:
            background-color var(--inactive-window-transition),
            margin-bottom var(--uc-hover-transition-duration) var(--uc-autohide-transition-type)
                var(--uc-hover-sidebar-delay),
            z-index 0ms linear var(--uc-hover-sidebar-delay) allow-discrete;
        --uc-hover-navbar-transition:
            transform var(--uc-hover-transition-duration) var(--uc-autohide-transition-type)
                var(--uc-hover-sidebar-delay),
            opacity var(--uc-hover-transition-duration) var(--uc-autohide-transition-type) var(--uc-hover-sidebar-delay);
        --uc-hover-personal-toolbar-transition:
            opacity var(--uc-hover-transition-duration) var(--uc-autohide-transition-type) var(--uc-hover-sidebar-delay),
            transform var(--uc-hover-transition-duration) var(--uc-autohide-transition-type)
                var(--uc-hover-sidebar-delay);
        --uc-hover-tabs-toolbar-windows-controls-transition:
            margin-block var(--uc-hover-transition-duration) var(--uc-autohide-transition-type)
                var(--uc-hover-sidebar-delay),
            margin-inline-end 0s var(--uc-autohide-transition-type) var(--uc-hover-sidebar-delay),
            opacity var(--uc-hover-transition-duration) var(--uc-autohide-transition-type) var(--uc-hover-sidebar-delay);

        /**/
        --uc-hover-navigator-tabbox-clip-path-start: inset(
            var(--uc-navigator-hover-clip-mica) 0 0 var(--uc-web-content-margin-outset-clip-mica)
        );
        --uc-hover-navigator-tabbox-clip-path-end: inset(
            var(--uc-navigator-hover-clip-mica) var(--uc-web-content-margin-outset-clip-mica) 0 0
        );
        --uc-hover-tabbox-clip-path-transition: clip-path var(--uc-hover-transition-duration)
            var(--uc-autohide-transition-type) var(--uc-hover-sidebar-delay);

        /**/
        --uc-hover-vt-tabbox-clip-path-start: inset(
            var(--uc-web-content-margin-outset-clip-mica) 0 0 var(--uc-sidebar-main-hover-clip-mica)
        );
        --uc-hover-vt-tabbox-clip-path-end: inset(
            var(--uc-web-content-margin-outset-clip-mica) var(--uc-sidebar-main-hover-clip-mica) 0 0
        );

        /**/
        --uc-hover-vt-sidebox-clip-path-start: inset(0 0 0 var(--uc-sidebar-main-hover-clip-mica));
        --uc-hover-vt-sidebox-clip-path-end: inset(0 var(--uc-sidebar-main-hover-clip-mica) 0 0);

        /**/
        --uc-hover-sidebar-main-tabbox-clip-path-start: inset(
            var(--uc-web-content-margin-outset-clip-mica) 0 0
                var(--uc-sb-sidebar-main-hover-clip-mica, var(--uc-web-content-margin-outset-clip-mica))
        );
        --uc-hover-sidebar-main-tabbox-clip-path-end: inset(
            var(--uc-web-content-margin-outset-clip-mica)
                var(--uc-sb-sidebar-main-hover-clip-mica, var(--uc-web-content-margin-outset-clip-mica)) 0 0
        );

        /**/
        --uc-hover-sidebery-tabbox-clip-path-start: inset(
            var(--uc-web-content-margin-outset-clip-mica) 0 0 var(--uc-sidebar-box-hover-clip-mica)
        );
        --uc-hover-sidebery-tabbox-clip-path-end: inset(
            var(--uc-web-content-margin-outset-clip-mica) var(--uc-sidebar-box-hover-clip-mica) 0 0
        );
    }

    /* Use hover transition timing when a menu is open */
    /*
    @media -moz-pref("uc.flex.auto-hide-navbar-and-keep-horizontal-tabs") and (not -moz-pref("sidebar.verticalTabs")) {
        &:has(
            #mainPopupSet
                > [panelopen]:not(
                    #ask-chat-shortcuts,
                    #selection-shortcut-action-panel,
                    #chat-shortcuts-options-panel,
                    #tab-preview-panel
                )
        ) {
            --uc-navigator-z-index: var(--uc-sb-bm-disable-autohide-z-index, 5);
            --uc-autohide-tabs-toolbar-transition: var(--uc-hover-tabs-toolbar-transition);
            --uc-autohide-navigator-transition: var(--uc-hover-navigator-transition);
            --uc-autohide-navbar-transition: var(--uc-hover-navbar-transition);
            --uc-autohide-personal-toolbar-transition: var(--uc-hover-personal-toolbar-transition);
            --uc-navbar-transform: 0;
            --uc-navbar-opacity: 1;
            --uc-tabs-toolbar-windows-controls-margin-right: 0;

            --uc-tabbox-clip-path-start: var(--uc-hover-navigator-tabbox-clip-path-start);
            --uc-tabbox-clip-path-end: var(--uc-hover-navigator-tabbox-clip-path-end);
            --uc-tabbox-clip-path-transition: var(--uc-hover-tabbox-clip-path-transition);
        }
    }
    */

    /*
    @media -moz-pref("uc.flex.fully-hide-toolbox") {
        --uc-navigator-transition:
            transform 82ms linear var(--uc-autohide-toolbox-delay), opacity 82ms linear var(--uc-autohide-toolbox-delay);
        --uc-urlbar-transition:
            transform 82ms linear var(--uc-autohide-toolbox-delay),
            opacity 0ms calc(var(--uc-autohide-toolbox-delay) + 82ms);
        @media -moz-pref("extensions.activeThemeID", "default-theme@mozilla.org") and -moz-pref("widget.windows.mica"),
            -moz-pref("uc.flex.sidebery-apply-expand-speed-to-toolbars"),
            -moz-pref("uc.flex.browser-wallpaper-enabled") {
            --uc-navigator-transition:
                transform var(--uc-autohide-transition-duration) var(--uc-autohide-transition-type)
                    var(--uc-autohide-sidebar-delay),
                opacity var(--uc-autohide-transition-duration) var(--uc-autohide-transition-type)
                    var(--uc-autohide-sidebar-delay);
            --uc-urlbar-transition:
                transform var(--uc-autohide-transition-duration) var(--uc-autohide-transition-type)
                    var(--uc-autohide-sidebar-delay),
                opacity 0ms var(--uc-autohide-transition-type)
                    calc(var(--uc-autohide-sidebar-delay) + var(--uc-autohide-transition-duration));
        }
    }
    */

    @media -moz-pref("sidebar.verticalTabs") {
        --tab-pinned-horizontal-count: 5;
        --uc-sidebar-main-width: var(--uc-sidebar-stripe-width);
        --uc-sidebar-main-hover-width: var(--uc-sidebar-hover-width);
        @media -moz-pref("uc.flex.disable-sidebery-autohide") {
            --uc-sidebar-main-width: var(--uc-sidebar-main-hover-width);
        }
        @media not -moz-pref("uc.flex.disable-sidebery-autohide") {
            &[titlepreface*="\180e "] {
                --uc-sidebar-main-width: var(--uc-sidebar-main-hover-width);
            }
        }
        --uc-sidebar-main-hover-clip-mica: calc(var(--uc-sidebar-main-hover-width) - var(--uc-sidebar-main-width));
        @media -moz-pref("uc.flex.fully-hide-sidebery") {
            --uc-sidebar-main-hover-clip-mica: var(--uc-sidebar-main-hover-width);
        }
        @media not -moz-pref("uc.flex.fully-hide-sidebery") {
            &:is([inFullscreen], [titlepreface*="\200c "], [titlepreface*="\200d "]) {
                --uc-sidebar-main-hover-clip-mica: var(--uc-sidebar-main-hover-width);
            }
        }
    }

    --uc-sidebar-box-hover-clip-mica: calc(var(--uc-sb-sidebar-hover-width) - var(--uc-sb-sidebar-width));
    @media -moz-pref("uc.flex.fully-hide-sidebery") {
        --uc-sidebar-box-hover-clip-mica: var(--uc-sb-sidebar-hover-width);
    }
    @media not -moz-pref("uc.flex.disable-sidebery-autohide") {
        &:is([inFullscreen], [titlepreface*="\200c "], [titlepreface*="\200d "]) {
            --uc-sidebar-box-hover-clip-mica: var(--uc-sb-sidebar-hover-width);
        }
    }

    /* Clip navigator in vertical tabs mode */
    @media -moz-pref("sidebar.verticalTabs") {
        --uc-navigator-hover-clip-mica: calc(var(--uc-bm-padding-box-height) + var(--uc-nav-bar-height));
        @media not (-moz-pref("uc.flex.disable-bookmarks-autohide") or -moz-pref("uc.flex.fully-hide-toolbox")) {
            &:not([inFullscreen], [titlepreface*="\200b "], [titlepreface*="\200d "]) {
                --uc-navigator-hover-clip-mica: var(--uc-bm-padding-box-height);
            }
        }
    }

    /* Clip navigator in horizontal tabs mode */
    @media not -moz-pref("sidebar.verticalTabs") {
        /* Fullscreen mode: clip all toolbars */
        --uc-navigator-hover-clip-mica: calc(
            var(--uc-bm-padding-box-height) + var(--uc-nav-bar-height) - var(--uc-autohide-navigator-bottom)
        );
        /* Non-fullscreen mode */
        @media not -moz-pref("uc.flex.fully-hide-toolbox") {
            &:not([inFullscreen], [titlepreface*="\200b "], [titlepreface*="\200d "]) {
                /* Default layout: only clip the bookmarks toolbar */
                --uc-navigator-hover-clip-mica: var(--uc-bm-padding-box-height);
                @media -moz-pref("uc.flex.disable-bookmarks-autohide") {
                    --uc-navigator-hover-clip-mica: var(--uc-web-content-margin-outset-clip-mica);
                }

                /** 
                 * When the tab bar is hidden: clip the tab bar height.
                 * Due to variable behavior, if Sidebery is active and the tab bar is not shown,
                 * only the bookmarks toolbar is clipped. 
                 */
                @media -moz-pref("uc.flex.auto-hide-horizontal-tabs-and-keep-navbar") and (not -moz-pref("uc.flex.auto-hide-navbar-and-keep-horizontal-tabs")) {
                    --uc-navigator-hover-clip-mica: calc(
                        var(--uc-bm-padding-box-height) - var(--uc-autohide-navigator-bottom)
                    );
                    @media -moz-pref("uc.flex.disable-bookmarks-autohide") {
                        --uc-navigator-hover-clip-mica: calc(
                            0px - var(--uc-autohide-navigator-bottom) + var(--uc-sb-navigator-hover-clip-mica, 0px)
                        );
                    }
                }

                /** 
                 * When the navbar is hidden: clip the navbar height.
                 * Due to variable behavior, if Sidebery is active, the navbar is not hidden
                 * and only the bookmarks toolbar is clipped. 
                 */
                @media -moz-pref("uc.flex.auto-hide-navbar-and-keep-horizontal-tabs") {
                    --uc-navigator-hover-clip-mica: calc(
                        var(--uc-bm-padding-box-height) + var(--uc-sb-navbar-hover-clip-mica, var(--uc-nav-bar-height))
                    );
                    @media -moz-pref("uc.flex.disable-bookmarks-autohide") {
                        --uc-navigator-hover-clip-mica: var(--uc-sb-navbar-hover-clip-mica, var(--uc-nav-bar-height));
                    }
                }
            }
        }
    }

    /* !TEMPORARY: This variable is a temporary solution and might be removed later. */
    #sidebar-main {
        --uc-sidebar-main-margin-left: 0px;
        &[sidebar-positionend] {
            --uc-sidebar-main-margin-left: 0px;
            --uc-sidebar-main-padding-inline-end: calc(
                (
                        var(--tab-collapsed-background-width) + 2 * var(--tab-inner-inline-margin) -
                            var(--uc-sidebar-stripe-width)
                    ) /
                    2 + 0.5px
            );
            &:hover {
                @media -moz-pref("uc.flex.fully-hide-sidebery") {
                    --uc-sidebar-main-padding-inline-end: calc(
                        var(--uc-sidebar-hover-trigger-width) - var(--uc-sidebar-stripe-width)
                    );
                }
                @media not -moz-pref("uc.flex.fully-hide-sidebery") {
                    :root:is([inFullscreen], [titlepreface*="\200c "], [titlepreface*="\200d "]) & {
                        --uc-sidebar-main-padding-inline-end: calc(
                            var(--uc-sidebar-hover-trigger-width) - var(--uc-sidebar-stripe-width)
                        );
                    }
                }
            }
        }

        @media not -moz-pref("uc.flex.disable-sidebery-autohide") {
            :root:not([titlepreface*="\180e "]) & {
                --uc-sidebar-main-margin-left: calc(
                    0px -
                        (
                            var(--tab-collapsed-background-width) + 2 * var(--tab-inner-inline-margin) -
                                var(--uc-sidebar-stripe-width)
                        ) /
                        2 + 0.5px
                );
                /*
                &[sidebar-positionend] {
                    --uc-sidebar-main-margin-left: -5px;
                }
                */
            }
        }
    }

    /* 🔼 End of initializing block */

    /* ════════════════════════════════════════════════════════════════════
    ███████╗██╗██████╗ ███████╗██████╗ ███████╗██████╗ ██╗   ██╗
    ██╔════╝██║██╔══██╗██╔════╝██╔══██╗██╔════╝██╔══██╗╚██╗ ██╔╝
    ███████╗██║██║  ██║█████╗  ██████╔╝█████╗  ██████╔╝ ╚████╔╝ 
    ╚════██║██║██║  ██║██╔══╝  ██╔══██╗██╔══╝  ██╔══██╗  ╚██╔╝  
    ███████║██║██████╔╝███████╗██████╔╝███████╗██║  ██║   ██║   
    ╚══════╝╚═╝╚═════╝ ╚══════╝╚═════╝ ╚══════╝╚═╝  ╚═╝   ╚═╝   
                                                                
       📌 VARIABLES FOR ACTIVE SIDEBERY
    
       These values apply only when Sidebery is active, including layout
       offsets and visibility-related adjustments.
    ════════════════════════════════════════════════════════════════════ */
    /* 🔽 Start of variable definitions for active Sidebery */
    &:has(#sidebar-box[sidebarcommand="_3c078156-979c-498b-8990-85f7987dd929_-sidebar-action"][sidebar-panel-open]) {
        --uc-sb-sidebar-header-stripe: color-mix(
            in srgb,
            var(--uc-sidebar-header-stripe) 50%,
            var(--uc-toolbar-bgcolor)
        ); /* Load user-defined value for internal calculations */
        @media (prefers-color-scheme: dark) {
            --uc-sb-sidebar-header-stripe: color-mix(
                in srgb,
                var(--uc-sidebar-header-stripe) 87%,
                var(--uc-toolbar-bgcolor)
            );
        }

        --uc-sb-sidebar-width: var(--uc-sidebar-width); /* Load user-defined value for internal calculations */
        --uc-sb-sidebar-hover-width: var(
            --uc-sidebar-hover-width
        ); /* Load user-defined value for internal calculations */
        /* When Sidebery autohide is disabled, fix its width to the expanded value */
        @media -moz-pref("uc.flex.disable-sidebery-autohide") {
            --uc-sb-sidebar-width: var(--uc-sb-sidebar-hover-width);
        }
        &:is([sidebar-expand-on-hover], [titlepreface*="\180e "]) {
            --uc-sb-sidebar-width: var(--uc-sb-sidebar-hover-width);
        }
        /* When Sidebery is fully hidden, set width to trigger width to allow hover-triggered expansion */
        @media -moz-pref("uc.flex.fully-hide-sidebery") {
            --uc-sb-sidebar-width: var(--uc-sidebar-hover-trigger-width);
        }
        @media not -moz-pref("uc.flex.fully-hide-sidebery") {
            &:is([inFullscreen], [titlepreface*="\200c "], [titlepreface*="\200d "]) {
                --uc-sb-sidebar-width: var(--uc-sidebar-hover-trigger-width);
            }
        }
        --uc-sb-sidebar-offset: var(--uc-sb-sidebar-width);
        @media -moz-pref("uc.flex.sidebery-allow-resizable-width") and (not -moz-pref("uc.flex.fully-hide-sidebery")) {
            &:not([inFullscreen], [titlepreface*="\200c "], [titlepreface*="\200d "]) {
                --uc-sb-sidebar-offset: var(--uc-sidebar-stripe-width);
                @media -moz-pref("uc.flex.disable-bookmarks-autohide") {
                    --uc-sb-sidebar-offset: 0px;
                }
            }
        }

        /* Adjust the top-left-right border radius of the web content area when Sidebery is active */
        @media not (-moz-pref("uc.flex.disable-sidebery-autohide") or -moz-pref("uc.flex.sidebery-allow-resizable-width")) {
            &:not([titlepreface*="\180e "]) {
                @media -moz-pref("sidebar.position_start") {
                    --uc-sb-web-content-radius-top-left: 0;
                    --uc-sb-web-content-radius-top-left-clip: 0;
                    --uc-sb-web-content-radius-top-right: var(--uc-web-content-radius);
                    --uc-sb-web-content-radius-top-right-clip: var(--uc-web-content-radius-clip);
                    @media -moz-pref("uc.flex.fully-hide-sidebery") or -moz-pref("uc.flex.fully-hide-toolbox") {
                        --uc-sb-web-content-radius-top-left: var(--uc-web-content-radius);
                        --uc-sb-web-content-radius-top-left-clip: var(--uc-web-content-radius-clip);
                    }
                }
                @media not -moz-pref("sidebar.position_start") {
                    --uc-sb-web-content-radius-top-left: var(--uc-web-content-radius);
                    --uc-sb-web-content-radius-top-left-clip: var(--uc-web-content-radius-clip);
                    --uc-sb-web-content-radius-top-right: 0;
                    --uc-sb-web-content-radius-top-right-clip: 0;
                    @media -moz-pref("uc.flex.fully-hide-sidebery") or -moz-pref("uc.flex.fully-hide-toolbox") {
                        --uc-sb-web-content-radius-top-right: var(--uc-web-content-radius);
                        --uc-sb-web-content-radius-top-right-clip: var(--uc-web-content-radius-clip);
                    }
                }
                @media not (-moz-pref("uc.flex.fully-hide-sidebery") or -moz-pref("uc.flex.fully-hide-toolbox")) {
                    &:is([titlepreface*="\200b "], [titlepreface*="\200c "]) {
                        --uc-sb-web-content-radius-top-left: var(--uc-web-content-radius);
                        --uc-sb-web-content-radius-top-left-clip: var(--uc-web-content-radius-clip);
                        --uc-sb-web-content-radius-top-right: var(--uc-web-content-radius);
                        --uc-sb-web-content-radius-top-right-clip: var(--uc-web-content-radius-clip);
                    }
                }
            }
        }

        /* Always apply margin when Sidebery is fully hidden, regardless of sidebar state */
        @media -moz-pref("sidebar.verticalTabs") and -moz-pref("uc.flex.enable-rounded-web-content") {
            --uc-sb-web-content-margin-side: var(--uc-web-content-margin);
        }

        /* If Sidebery is active and either fully hidden or in fullscreen mode, 
            clip the background to reveal the Mica backdrop */
        @media -moz-pref("sidebar.verticalTabs") {
            --uc-sb-sidebar-main-hover-clip-mica: var(--uc-sidebar-stripe-width);
        }

        @media not -moz-pref("sidebar.verticalTabs") {
            --uc-sb-navbar-hover-clip-mica: 0px;
            /* If Sidebery is active while horizontal tabs are fully hidden, 
                the clipped height doesn't need to account for the tab bar */
            @media -moz-pref("uc.flex.disable-bookmarks-autohide") {
                --uc-sb-navbar-hover-clip-mica: var(--uc-web-content-margin-outset-clip-mica);
                --uc-sb-navigator-hover-clip-mica: var(--uc-web-content-margin-outset-clip-mica);
            }

            /* Position of the sidebar button icon in horizontal tab mode when Sidebery is active */
            --uc-sb-sidebar-button-offset: var(--uc-sidebar-stripe-width);
            --uc-sb-sidebar-button-bg-pos: absolute;
            --uc-sb-sidebar-button-bg-size: 20px;
            --uc-sb-sidebar-button-bg-pos-first: 13px 10px;
            --uc-sb-sidebar-button-bg-pos-first-fs: 11px 10px;
            --uc-sb-sidebar-button-bg-pos-last: 8.5px 1.5px;
            --uc-sb-sidebar-button-height-last: 23px;
            @media -moz-pref("uc.flex.increase-navbar-height") {
                --uc-sb-sidebar-button-bg-pos-first: 13px 12px;
                --uc-sb-sidebar-button-bg-pos-first-fs: 11px 12px;
                --uc-sb-sidebar-button-bg-pos-last: 8.5px 3px;
                --uc-sb-sidebar-button-height-last: 26px;
            }

            /* Initial values for window controls positioning */
            /* --uc-nav-bar-padding-right: 104px; */ /* Reserve space on the nav bar's right for window controls */
            /*
            --uc-windows-controls-visibility: visible;
            --uc-windows-controls-position: absolute;
            --uc-windows-controls-top: 2px;
            --uc-windows-controls-right: 0px;
            &[inFullscreen] {
                --uc-windows-controls-top: 0px;
            }
            */

            /* Property values for the window controls when auto-hide navbar is enabled and Sidebery is active */
            @media not -moz-pref("sidebar.verticalTabs") {
                @media -moz-pref("uc.flex.auto-hide-navbar-and-keep-horizontal-tabs") or -moz-pref("uc.flex.restore-window-controls-on-tabbar") {
                    --uc-tabs-toolbar-windows-controls-display: none;
                    --uc-navbar-windows-controls-display: flex;
                    --uc-sb-nav-bar-padding-right: 0px;
                    --uc-sb-tabs-toolbar-windows-controls-transition:
                        width 0.5s ease-in-out, margin-inline-end 0.5s ease-in-out, opacity 0s 0.5s;
                }
            }

            /* 
             * When vertical tabs are not enabled but Sidebery is active, 
             * add spacing after the first item to align with Sidebery's layout. 
             */
            @media not (-moz-pref("uc.flex.disable-nav-bar-first-item-right-padding") or -moz-pref("uc.flex.fully-hide-toolbox") or -moz-pref("uc.flex.fully-hide-sidebery")) {
                &:not([titlepreface*="\200b "], [titlepreface*="\200c "], [titlepreface*="\200d "]) {
                    --uc-nav-bar-first-child-padding-right: 6px;
                }
            }
            /* Adjust vertical offset of the bookmarks toolbar background image */
            /*
             * Use a variable to pass the offset value instead of assigning element-specific
             * variables inside the :root:has() block, to reduce performance cost.
             */
            --uc-sb-theme-bg-y-offset: 44px;

            /* Hide horizontal tab bar when Sidebery is active in fullscreen (and not customizing) */
            &[inFullscreen]:not([customizing]) {
                --uc-sb-tab-items-visibility: collapse;
            }
            &:not([inFullscreen]):not([customizing]) {
                @media not -moz-pref("uc.flex.auto-hide-horizontal-tabs-and-keep-navbar"),
                    -moz-pref("uc.flex.fully-hide-toolbox") {
                    --uc-sb-tab-items-visibility: collapse;
                }
                @media not -moz-pref("uc.flex.fully-hide-toolbox") {
                    &:is([titlepreface*="\200b "], [titlepreface*="\200d "]) {
                        --uc-sb-tab-items-visibility: collapse;
                    }
                }
                @media -moz-pref("uc.flex.auto-hide-navbar-and-keep-horizontal-tabs") {
                    --uc-sb-tab-items-visibility: collapse;
                }
            }

            /* Values used by uc-tabs-bar.css when Sidebery is active */
            --uc-autohide-navigator-bottom: 0px;
            &:not([customizing]) {
                --uc-sb-bm-disable-autohide-z-index: 0;
                --uc-autohide-tabstoolbar-bottom: var(--uc-autohide-bottom);
                --uc-navbar-transform: 0;
                --uc-navbar-offset-y: 0;
                --uc-navbar-opacity: 1;
                /*
                --uc-autohide-navigator-delay: 0s;
                */
                --uc-autohide-tabstoolbar-visibility: hidden;
                /*
                --uc-autohide-tabstoolbar-delay: var(--uc-tabs-hide-animation-delay);
                */
            }
        }

        @media -moz-pref("sidebar.revamp") {
            /**
             * When the new sidebar is enabled and in fullscreen mode,
             * reduce the navbar's trigger area so the top-aligned sidebar stripe
             * can receive hover events before the navbar expands. 
             */
            &[inFullscreen] {
                --uc-toolbox-rotation: 87deg;
            }
        }
    }
    /* 🔼 End of variable definitions for active Sidebery */

    /* ════════════════════════════════════════════════════════════════════
    ██████╗  ██████╗  ██████╗ ██╗  ██╗███╗   ███╗ █████╗ ██████╗ ██╗  ██╗███████╗
    ██╔══██╗██╔═══██╗██╔═══██╗██║ ██╔╝████╗ ████║██╔══██╗██╔══██╗██║ ██╔╝██╔════╝
    ██████╔╝██║   ██║██║   ██║█████╔╝ ██╔████╔██║███████║██████╔╝█████╔╝ ███████╗
    ██╔══██╗██║   ██║██║   ██║██╔═██╗ ██║╚██╔╝██║██╔══██║██╔══██╗██╔═██╗ ╚════██║
    ██████╔╝╚██████╔╝╚██████╔╝██║  ██╗██║ ╚═╝ ██║██║  ██║██║  ██║██║  ██╗███████║
    ╚═════╝  ╚═════╝  ╚═════╝ ╚═╝  ╚═╝╚═╝     ╚═╝╚═╝  ╚═╝╚═╝  ╚═╝╚═╝  ╚═╝╚══════╝
                                                                                 
       🧭 OFFSETS FOR BOOKMARKS TOOLBAR & NAVIGATOR
    
       These styles control spacing and layout shifts for the toolbar
       and navigator depending on sidebar visibility and position.
    ════════════════════════════════════════════════════════════════════ */
    /* 🔽 Start of offset block for bookmarks toolbar and navigator */
    --uc-navigator-offset: var(--uc-sb-sidebar-offset, 0px);
    --uc-navigator-width: var(--uc-sb-sidebar-offset, 0px);
    --uc-personal-toolbar-offset: var(--uc-sb-sidebar-offset, 0px);
    --uc-personal-toolbar-width: var(--uc-sb-sidebar-offset, 0px);

    /* Adjust vertical offset of the bookmarks toolbar background image */
    #PersonalToolbar {
        --uc-theme-bg-y-offset: 0px;
        @media -moz-pref("uc.flex.increase-navbar-height") {
            --uc-theme-bg-y-offset: 3px;
        }
        --uc-theme-bg-y-clip: calc(-25px - var(--uc-theme-bg-y-offset) + var(--uc-sb-theme-bg-y-offset, 0px));
        /* !v143 */
        #toolbar-menubar:not([autohide="true"]):not([autohide=""]) ~ & {
            --uc-theme-bg-y-clip: calc(-46px - (2 * var(--uc-theme-bg-y-offset)) + var(--uc-sb-theme-bg-y-offset, 0px));
        }
        /* !v143 */
        #toolbar-menubar:where([autohide="true"], [autohide=""]):not([inactive]) ~ & {
            --uc-theme-bg-y-clip: calc(-46px - var(--uc-theme-bg-y-offset) + var(--uc-sb-theme-bg-y-offset, 0px));
        }
        @media -moz-pref("sidebar.verticalTabs") {
            --uc-theme-bg-y-clip: calc(26px + var(--uc-theme-bg-y-offset));
            /* !v143 */
            #toolbar-menubar:not([autohide="true"]):not([autohide=""]) ~ & {
                --uc-theme-bg-y-clip: calc(47px + 2 * var(--uc-theme-bg-y-offset));
            }
            /* !v143 */
            #toolbar-menubar:where([autohide="true"], [autohide=""]):not([inactive]) ~ & {
                --uc-theme-bg-y-clip: calc(43px + var(--uc-theme-bg-y-offset));
            }
        }
    }
    /* Initial values for horizontal offset of the bookmarks toolbar background image */
    --uc-theme-bg-x-left-start: 0px;
    --uc-theme-bg-x-right-end: 0px;

    /* Adjust horizontal offset of the bookmarks toolbar background image */
    @media not (-moz-pref("uc.flex.disable-bookmarks-autohide") or -moz-pref("uc.flex.fully-hide-toolbox") or -moz-pref("uc.flex.fully-hide-sidebery")) {
        &:not(
            [inFullscreen],
            [customizing],
            [titlepreface*="\200b "],
            [titlepreface*="\200c "],
            [titlepreface*="\200d "]
        ) {
            --uc-theme-bg-x-left-start: calc(-1 * var(--uc-sb-sidebar-offset, 0px));
            @media -moz-pref("sidebar.verticalTabs") {
                --uc-theme-bg-x-left-start: calc(
                    -1 * var(--uc-theme-bg-x-collapsed-left-start, var(--uc-sidebar-main-width))
                );
            }
            --uc-theme-bg-x-right-end: var(--uc-theme-bg-x-offset);

            @media not -moz-pref("sidebar.position_start") {
                --uc-theme-bg-x-left-start: var(--uc-theme-bg-x-offset);
                --uc-theme-bg-x-right-end: calc(-1 * var(--uc-sb-sidebar-offset, 0px));
                @media -moz-pref("sidebar.verticalTabs") {
                    --uc-theme-bg-x-right-end: calc(
                        -1 * var(--uc-theme-bg-x-collapsed-right-end, var(--uc-sidebar-main-width))
                    );
                }
            }
        }
    }

    @media -moz-pref("sidebar.verticalTabs") {
        --uc-navigator-offset: var(
            --uc-sb-sidebar-offset,
            var(--uc-sidebar-main-collapsed-width, var(--uc-sidebar-main-width))
        );
        --uc-navigator-width: var(
            --uc-sb-sidebar-offset,
            var(--uc-sidebar-main-collapsed-width, var(--uc-sidebar-main-width))
        );
        @media not -moz-pref("uc.flex.disable-bookmarks-autohide") {
            --uc-personal-toolbar-offset: var(
                --uc-sb-sidebar-offset,
                var(--uc-sidebar-main-collapsed-width, var(--uc-sidebar-main-width))
            );
            --uc-personal-toolbar-width: var(
                --uc-sb-sidebar-offset,
                var(--uc-sidebar-main-collapsed-width, var(--uc-sidebar-main-width))
            );
            /** 
             * When "Hide tabs and sidebar" is enabled in sidebar settings
             * and the sidebar toggle button is in a collapsed state,
             * the sidebar is fully hidden, so all offsets are set to 0 
             */
            @media -moz-pref("sidebar.visibility", "hide-sidebar") {
                /**
                 * Using #navigator-toolbox:has(#sidebar-button:not([expanded])) could avoid the cost of :root:has(),
                 * but it stops working if #sidebar-button is placed inside #customization-container,
                 * since it's no longer part of the active DOM.
                 * Given that the rule is behind a @media query and uses variable forwarding to limit scope,
                 * the overall performance impact of :root:has() is minimal in most cases,
                 * so we chose the more robust :root:has() version here.
                 */
                &:has(#sidebar-main[hidden]) {
                    --uc-personal-toolbar-offset: 0px;
                    --uc-personal-toolbar-width: 0px;
                    --uc-theme-bg-x-left-start: 0px;
                    --uc-theme-bg-x-right-end: 0px;
                }
            }

            /* 
             * When Sidebery is set to stay expanded (via uc.flex.disable-sidebery-autohide)
             * and the sidebar toggle button is in a collapsed state (no [sidebar-launcher-expanded]),
             * the toolbar offset depends on whether Sidebery is active:
                - If Sidebery is active, the offset equals the Sidebery hover width.
                - If Sidebery is inactive, the offset falls back to the native collapsed sidebar (stripe) width. 
             */
            @media not -moz-pref("sidebar.visibility", "hide-sidebar") {
                &:has(#sidebar-main:not([sidebar-launcher-expanded])) {
                    @media -moz-pref("uc.flex.disable-sidebery-autohide") {
                        --uc-sidebar-main-collapsed-width: var(--uc-sidebar-stripe-width);
                        @media -moz-pref("sidebar.position_start") {
                            --uc-theme-bg-x-collapsed-left-start: var(
                                --uc-sb-sidebar-offset,
                                var(--uc-sidebar-stripe-width)
                            );
                        }
                        @media not -moz-pref("sidebar.position_start") {
                            --uc-personal-toolbar-offset: 0;
                            --uc-theme-bg-x-collapsed-right-end: var(
                                --uc-sb-sidebar-offset,
                                var(--uc-sidebar-stripe-width)
                            );
                        }
                    }
                    @media not -moz-pref("uc.flex.disable-sidebery-autohide") {
                        &[titlepreface*="\180e "] {
                            --uc-sidebar-main-collapsed-width: var(--uc-sidebar-stripe-width);
                            @media -moz-pref("sidebar.position_start") {
                                --uc-theme-bg-x-collapsed-left-start: var(
                                    --uc-sb-sidebar-offset,
                                    var(--uc-sidebar-stripe-width)
                                );
                            }
                            @media not -moz-pref("sidebar.position_start") {
                                --uc-personal-toolbar-offset: 0;
                                --uc-theme-bg-x-collapsed-right-end: var(
                                    --uc-sb-sidebar-offset,
                                    var(--uc-sidebar-stripe-width)
                                );
                            }
                        }
                    }
                }
            }
        }
    }
    /**
     * When the sidebar is positioned on the right ([sidebar-positionend]),
     * ensure the following variables take precedence over all previous cases.
     */
    @media not -moz-pref("sidebar.position_start") {
        --uc-nav-bar-first-child-padding-right: 0px;
        --uc-navigator-offset: 0px;
        --uc-personal-toolbar-offset: 0px;
    }
    /* 🔼 End of offset block for bookmarks toolbar and navigator */
}
